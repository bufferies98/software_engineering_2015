require 'word_counter/result'

module WordCounter
	class Parser
		def self.parse(string)
		answer = Result.new
		p = 0
		words_h = Hash.new()
		sds = string.downcase.split(" ")
		sds.each do |wor|
			p = p + wor.scan(/[^a-z_]/).count
			words = wor.split(/[.,(+-]/)
			words.each do |word|
				word = word.gsub(/[^a-z_]/,'')
					if (word == '_')
						p = p + 1
						word = word.gsub("_",'')
					end
				if (word !='')
					if (words_h[word])
						words_h[word] += 1
					else 
						words_h[word] = 1
					end
				end
			end
		end
		words_h = words_h.sort_by { |key, value| [-val6ue, key]}
		answer.setWordsMarks words_h, p
		answer
		end
	end
end
